\section{Preliminaries}
\label{sec:torsion}
In this chapter we discuss springs with torsion. This is also
called the dynamic \emph{Kirchhoff} problem in literature.
We try to build effective and robust software that models
the dynamics behavior of springs that have a prescribed natural curvature.

A complete mathematical description of the Kirchhoff problem can be
found in the work of Love \cite{love}. This work however was done
much earlier than when computers were even invented and so the problem
of numerical modeling of such behavior has not been addressed.

Thomson (the brother of Lord Kelvin) \cite{thomson} also looked
specifically at helical springs and established geometric
relationships between the various spring parameters such as
pitch angle, static load, coil curvature and the radius of the
spring helix. Many later works that model [citation needed]
make simplifying assumptions. For example, they usually assume
that the springs are in a helical shape with constant pitch
angle and radius of the spring helix. Not only that they also
model the static behavior.

\section{The transported natural curvature and the natural frame.}
The key to the Kirchhoff problem is to find a way to describe the
curvature of the dynamic spring. Since the spring is in motion the
curvature at a certain point when at rest and the curvature at the
same point, say 1 second later, can not be compared because we will be
in a different coordinate system then.

Let us assume that the equation describing the spring is given by
function \[\bx(s) : [0, L] \to \mathbb{R}^3\] where,
\begin{equation}
  \bx(s) = [x_1(s), x_2(s), x_3(s)]^T
\end{equation}
and \(L\) is the arc length of the spring and \(s\) is the arc length
of the spring along the rod. Hence the function \(x(s)\) satisfies
the equation
\begin{equation} \label{length_der_wrt_s}
  \abs{\bx'(s)}^2 = x'_1(s)^2 + x'_2(s)^2 + x'_3(s)^2 = 1
\end{equation}
In here the prime denotes derivative with respect to the
arc length. Note that we have suppressed the time dependence
of the equation. For now we may assume that the function
\(\bx\) is for a fixed time. We will use the usual convention of
denoting the derivative with respect to time by putting a dot over
the variable.

We define the \emph{curvature} of the spring to be the vector
\(\bx''(s)\). 
\begin{rmk}
The traditional definition for the \emph{curvature} \(\bkappa\)
of a space curve is defined as
\[\bkappa = \aabs{\frac{d\bT}{ds}}\]
where \(\bT\)is the unit tangent vector given by
\[\bT = \frac{\bx'(s)}{\abs{\bx'(s)}}.\] By
(\ref{length_der_wrt_s}), we have \(\bkappa = \abs{\bx''(s)}\). 
\end{rmk}
The above remark shows that it makes sense for us to define
\emph{curvature} the way we have defined it.
By (\ref{length_der_wrt_s}) again we have \(\bx'(s) \cdot \bx'(s) = 1\).
Taking derivatives with respect to \(s\) of this equation gives us
\(\bx'(s) \cdot \bx''(s) = 0 \). This shows that \(\bx''(s)\) is
always perpendicular to the tangent vector  \(\bx'(s)\).

When the spring is at rest, and has no forces applied to it, we will
denote this state of the spring \(\bx\) as \(\bx_0\) the path of the
spring. (This is essentially the state of the spring at time \(t =
0\)). We call the function \(\bx''_0(s)\) the \emph{natural curvature.}
Then, in principal we can determine one part of the difference in
potential energy by seeing how much \(\bx''(s)\) differs from
\(\bx''_0(s)\). However we cannot actually compute this difference
because \(\bx(s)\) and \(\bx_0(s)\) are at different points.

Thus, in order to have a point of comparison define the
concept of \emph{transported natural curvature}. Suppose the spring is
at rest state and attach to each point on the spring the curvature
vector \(\bx''_0(s)\). This is illustrated in the [Fig goes here]
\texttt{fig citation needed.} We then stretch out the spring until
is completely straight and we do so without introducing any internal
twisting or torsion to the rod. Note that is only a mathematical
idealization. In reality such a maneuver will add internal twisting
to the spring. We then obtain what is illustrated in \texttt{Fig
  citation needed}. The curvature vectors we previously attached to the
spring now moves with the points on the spring but they remain
perpendicular to the now straight rod.
Let us assume that the point \(\bx_0(s)\) is transported to the point
\([s, 0, 0]^T\), i.e., the spring is stretched out along the positive
\(x\)--axis.
\begin{nt}
\(\bkappa(s)\) denotes the transported natural curvature at \([s, 0, 0]\).
\end{nt}
Observe that only the second and third coordinates of \(\bkappa(s)\)
are non zero. This is because for each transported natural curvature
vector must have tail coordinates of the form \((s, 0, 0)\) and its
head must have coordinates of the form \((s, y_s, z_s)\) and so the
direction vector must be of the form \([0, y_s, z_s]\).
To carry out the straightening of the rod we introduce the our next subject.
\section{Natural Frames}
\label{sec:natural-frames}
A \emph{frame} is a triple of vectors \(\sR = [\br_1, \br_2, \br_3]\)
that are orthonormal. By definition it follows that the square matrix
\(\sR\) is such that \(\sR \sR^T = \sI_3\) where \(\sI_3\) denotes the
\(3 \times 3\) identity matrix. In other words the matrix \(\sR\) is
orthogonal and in particular \(\sR^{-1} = \sR^T\).

We now introduce the concept of a \emph{Natural frame}. Pick any frame
\(\sR_0(s)\) attached to the point \(x_0(s)\). Suppose now, that we
move tangent to the spring to the point \(\bx_0(s)\)with minimal
amount of ration necessary. Denote by \(\sR_0(s)\) the frame that's
been carried to the point \(\bx_0(s)\). Once we have chosen
\(\sR_0(0)\), the frame \(\sR_0(s)\) is uniquely determined. Indeed, for
the sake of convenience let us agree that we chose \(\sR_0(0)\) as follows:
\[
  \sR_0(0) = \begin{bmatrix}
    \mid & \mid & \mid\\
    \bx'_0(0) & \br_2 & \br_3 \\
    \mid & \mid & \mid
    \end{bmatrix}
\]
In particular the first column of \(\sR_0(0)\) is chosen to be
\(\bx'_0(0)\) whereas \(\br_2\) and \(\br_3\) are chosen arbitrarily
so long as they adhere to the obvious restriction that \(\sR_0(0)\)
be a frame. 
A picture of how a natural frame evolves along the frame is shown in
\texttt{\fbox{Fig Cite}}. Each column of the natural frame
\(\sR_0(s)\) can now  be computed by solving for \(\br(s)\) the
differential equation
\begin{equation}\label{natural_frame}
\br'(s) = \left( \bx'_0(s) \times \bx''_0(s) \right) \times \br(s)
\end{equation}
where \(\br(s)\) denotes an element(column) of \(\sR_0(s)\).
We are of course, using each respective column of \(\sR_0(0)\)
as an initial condition in the solution of (\eqref{natural_frame})

Note that \(\bx'(s)\) is a solution of (\refeq{natural_frame}).
Indeed, if we set \(\br(s) = \bx_0'(s)\) on the right hand side of
(\refeq{natural_frame}) we get,
\begin{align*}
  & \bx_0''(s)\left( \bx_0'(s) \cdot \bx_0'(s) \right) - \bx_0'(s) \left(
    \bx_0'(s) \cdot \bx_0''(s) \right) \\
  &  = \bx_0''(s) \left( 1 \right) - \bx_0'(s) \left( 0 \right) \\
  & = \bx''(s)
\end{align*}
which is precisely the left hand side of (\refeq{natural_frame}) with
\(\br(s) = \bx'(s)\). It is now clear that the first element(column)
of \(\sR_0(s)\) will always be \(\bx_0'(s)\). This concept appears in
literature as the so called \emph{Fermi--Walker transport} in
General Relativity. \cite{gravitation}. 

We can now write the equation for natural curvature as
\begin{equation} \label{transported_natural_curvature}
\bkappa(s)  = \sR_0(s)^{-1} \bx''_0(s) = \sR_0^T\bx''_0(s)
\end{equation}
For a general spring, the transported natural curvature can easily
be computed numerically. In fact, for a helical spring the transported
natural curvature can even be computed analytically. In the next
section we show how this can be done both analytically as well as
numerically.

\section{Helical springs}
\label{sec:spiral-spring}
\subsection{Notation}
\label{sec:notation}
First let us introduce some useful notation. For any vector \(\bv \in
\mathbb{R}^3\), where \(\bv = [v_1, v_2, v_3]^T\) define the anti
symmetric matrix
\[
\sO_{\bv} =
\begin{bmatrix}
  0 & -v_3 & v_2 \\
  v_3 & 0 & -v_1 \\
  -v_2 & v_1 & 0
\end{bmatrix}
\]
Notice that for any \(\bv, \bw \in \mathbb{R}^3\) we have
\[
\sO_{\bv} \bw = \bv \times \bw
\]
We now prove a couple of useful lemmas.
\begin{prop}
  For \(s \in \mathbb{R}\), we have
  \[
    \exp\left( s \sO_\bi \right) =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & \cos(s) & - \sin(s) \\
      0 & \sin(s) & \cos(s)
    \end{bmatrix}
  \]
  where \(\bi = [1, 0, 0]^T\).
\begin{proof}
  Note that
  \[
s\sO_\bi =
\begin{bmatrix}
  0 & 0 & 0 \\
  0 & 0 & -s \\
  0 & s & 0
\end{bmatrix}
  \]
  Denote \(M = s \sO_\bi\) and let \(I\) denote the \(3 \times 3\)
  identity matrix. Now note that
  \(M^3 = -s^2M\). Therefore we must have that
  \(M^{2n + 1} = (-1)^ns^{2n}M\) and \(M^{2n} = (-1)^{n-1}s^{2n - 2}
  M^2\) for \(n \in \mathbb{N}\). Therefore,
  \begin{align*}
    \label{eq:3}
    \exp(M) & = I + \sum_{k = 1}^{\infty} \frac{M^k}{k!}  \\
            & =I + \sum_{n = 0}^{\infty} \frac{M^{2n + 1}}{(2n + 1)!} +
              \sum_{n = 1}^{\infty} \frac{M^{2n}}{(2n)!} \\
            & = I + \sum_{n = 0}^{\infty} \frac{(-1)^n s^{2n} M}{(2n +
              1)!} +
              \sum_{n = 1}^{\infty} \frac{(-1)^{n - 1} s^{2n -
              2}M^2}{(2n)!} \\
            & = I + \frac{M}{s} \sum_{n = 0}^{\infty} \frac{(-1)^n
              s^{2n +1}}{(2n +1)!} -
              \frac{M^2}{s^2}\sum_{n = 1}^{\infty} \frac{(-1)^{n}
              s^{2n}}{(2n)!} \\
            & = I + \frac{\sin(s)}{s} M + \frac{1 - \cos(s)}{s^2} M^2 \\
            & = I + \sin(s) \sO_{\bi} + \frac{1 - \cos(s)}{s^2}M^2
  \end{align*}
It now easily follows that \(\exp(s\sO_{\bi})\) has the intended matrix form.
\end{proof}  
\end{prop}

\begin{prop}
For any \(\sr \in \SO(3)\) and for \(\bi = [1, 0, 0]^T\)
we must have
  \begin{equation} \label{eq:conjugation_by_r}
    \sr \sO_{\bi} \sr^{-1} = \sO_{\sr \bi}
  \end{equation}
\end{prop}
\begin{proof}
  The canonical form for any \(\sr \in \SO(3)\) is
  \[
\sr =
\begin{bmatrix}
  1 & 0 & 0 \\
  0 & p & t \\
  0 & q & u
\end{bmatrix}
\]
Also note that since \(\sr \in \SO(3)\) we have \(r^{-1} = r^T\) and
\(\det(\sr) = 1\). In particular \(pu - qt = 1\).
Thus,
\begin{align*}
  r\sO_{\bi}r^{-1} & =
                       \begin{bmatrix}
                         0 & 0 & 0 \\
                         0 & 0 & -pu + tq \\
                         0 & -qt + pu & 0
                       \end{bmatrix} \\
                   & =
                     \begin{bmatrix}
                       0 & 0 & 0 \\
                       0 & 0 & -1 \\
                       0 & 1 & 0
                     \end{bmatrix} \\
                   & = \sO_{\sr \bi}
\end{align*}
\end{proof}

Suppose that spiral spring is given by
\begin{equation}
  \label{eq:spiral-spring}
  \bx_0(s) = \left[ \alpha s, \beta \cos(\gamma s), \beta \sin(\gamma s) \right]^T
\end{equation}
where \(\alpha^2 + \beta^2 \gamma^2 = 1\). Then,
\begin{align}
  \bx'_0(s) \times \bx''_0(s) & = \langle \beta^2 \gamma^3,
                                \alpha \beta \gamma^2 \sin(\gamma s),
                                - \alpha \beta \gamma^2 \cos(\gamma
                                s)\rangle \label{eq:cross-prod} \\
                                & = \gamma\bi - \alpha \gamma
                                  \bx_0'(s) 
\end{align}
Let \(\br(s) = [r_0(s), r_1(s), r_2(s)]^T\). Then,
\eqref{natural_frame} may be rewritten as
\begin{align}
\br'(s) & = \langle \beta^2 \gamma^3,
            \alpha \beta \gamma^2 \sin(\gamma s),
            - \alpha \beta \gamma^2 \cos(\gamma s)\rangle \times
          \br(s) \\
        & =
          \begin{bmatrix}
            0 & \alpha \beta\gamma^2 \cos(\gamma s) & \alpha \beta
            \gamma^2 \sin(\gamma s) \\
            - \alpha \beta \gamma^2 \cos(\gamma s) & 0 & -\beta^2
            \gamma^3 \\
            -\alpha \beta \gamma^2 \sin(\gamma s) & \beta^2 \gamma^3 & 0
          \end{bmatrix} \br(s) \label{as_skew_sym}
\end{align}


First we compute the \emph{Transported natural curvature} of the
spring in the specific case of \( \alpha = \tfrac{1}{2}, \beta =
\tfrac{\sqrt 3}{2}\) and \(\gamma = 1\). We then have,








%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
